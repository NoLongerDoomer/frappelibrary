<!DOCTYPE html>
<html>

<head>
    <title>Welcome Librarian!</title>
    <script src="{{url_for('static', filename='js/jquery.js')}}"></script>
    <link href="{{url_for('static', filename='css/bootstrap.css')}}" rel="stylesheet">
    <script src="{{url_for('static', filename='js/bootstrap.js')}}"></script>
    <link href="{{url_for('static', filename='css/datatables.css')}}" rel="stylesheet">
    <script src="{{url_for('static', filename='js/datatables.js')}}"></script>
    <style>
        body {
            margin-left: 200px;
        }
    </style>
</head>

<body>
    <div class="container">
        <button class="btn btn-primary">Add Books</button>
    </div>
    <div class="container booktable">
        <table class="table table-striped table-bordered" id="booktable">
            <thead>
                <tr>
                    <th id="bookID" scope=" col">Book Id</th>
                    <th id="title" scope="col">Title</th>
                    <th id="authors" scope="col">Authors</th>
                    <th id="average_ratings" scope="col">Average Ratings</th>
                    <th id="isbn" scope="col">ISBN</th>
                    <th id="isbn13" scope="col">ISBN13</th>
                    <th id="language_code" scope="col">Language Code</th>
                    <th id="num_pages" scope="col">Pages</th>
                    <th id="ratings_count" scope="col">Ratings Count</th>
                    <th id="text_reviews_count" scope="col">Review Counts</th>
                    <th id="publication_date" scope="col">Publication Date</th>
                    <th id="publisher" scope="col">Publisher</th>
                    <th id="count" scope="col">Count</th>
                    <th scope="col">Edit</th>
                    <th scope="col">Delete</th>
                </tr>
            </thead>
            <tbody>
                {% for book in books %}
                <tr>
                    <td>{{book.book_id}}</td>
                    <td>{{book.title}}</td>
                    <td>{{book.authors}}</td>
                    <td>{{book.average_rating}}</td>
                    <td>{{book.isbn}}</td>
                    <td>{{book.isbn13}}</td>
                    <td>{{book.language_code}}</td>
                    <td>{{book.num_pages}}</td>
                    <td>{{book.ratings_count}}</td>
                    <td>{{book.text_reviews_count}}</td>
                    <td>{{book.publication_date}}</td>
                    <td>{{book.publisher}}</td>
                    <td>{{book.count}}</td>
                    <td><button class="editbutton">Edit</button></td>
                    <td><button>Delete</button></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div id="editmodal" class="modal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit here</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <input name="editmodal" type="hidden" id="edit_id">
                        <label class="col-sm-4">Title: </label>
                        <input name="editmodal" id="edit_title" type="text" class="col-sm-4">
                        <label class="col-sm-4">Authors: </label>
                        <input id="edit_authors" type="text" class="col-sm-4">
                        <label class="col-sm-4">Average Ratings: </label>
                        <input id="edit_ratings" type="text" class="col-sm-4">
                        <label class="col-sm-4">ISBN: </label>
                        <input id="edit_isbn" type="text" class="col-sm-4">
                        <label class="col-sm-4">ISBN13: </label>
                        <input id="edit_isbn13" type="text" class="col-sm-4">
                        <label class="col-sm-4">Language Code: </label>
                        <input id="edit_language" type="text" class="col-sm-4">
                        <label class="col-sm-4">Pages: </label>
                        <input id="edit_page" type="text" class="col-sm-4">
                        <label class="col-sm-4">Ratings Count: </label>
                        <input id="edit_ratings" type="text" class="col-sm-4">
                        <label class="col-sm-4">Reviews count: </label>
                        <input id="edit_reviews" type="text" class="col-sm-4">
                        <label class="col-sm-4">Publication Date: </label>
                        <input id="edit_publication" type="text" class="col-sm-4">
                        <label class="col-sm-4">Publisher: </label>
                        <input id="edit_publisher" type="text" class="col-sm-4">
                        <label class="col-sm-4">Count: </label>
                        <input id="edit_count" type="text" class="col-sm-4">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // $('#booktable tr td').blur(function (event) {
        //     var value = event.target.innerHTML;
        //     var node = $('tr th').eq($(this).index());
        //     var column = node[0].getAttribute('id');
        //     var id = event.target.parentElement
        //         .firstElementChild.innerHTML;
        //     $.ajax({
        //         type: "POST",
        //         url: "updatebooks",
        //         data: {
        //             "column": column,
        //             "value": value,
        //             "id": id
        //         },
        //         success: function (result) {
        //             console.log(result);
        //         }
        //     })
        // });
        // $(document).ready(function () {
        //     $('#booktable').DataTable();
        // });
        // $(document).ready(function () {
        //     $('#editmodal').show();
        // })


        // $("td button").click(function (event) {
        //     console.log(event.target);
        // });


        $('.booktable button').click(function (event) {
            console.log((event.target.parentElement.parentElement.children)[0].innerHTML);
            var editData = event.target.parentElement.parentElement.children;
            console.log(editData);
            var editModalInput = document.getElementsByName('editmodal');
            // editModalInput[0]. = editData[0].innerHTML;
            editModalInput[0].value = 100;
            $('#editmodal').show();
            console.log(editModalInput);
        })
    </script>
</body>

</html>